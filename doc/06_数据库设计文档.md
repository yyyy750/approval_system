# 审批系统 - 数据库设计文档

## 1. 数据库概述

| 项目 | 说明 |
|------|------|
| 数据库 | MySQL 8.0 |
| 字符集 | utf8mb4 |
| 排序规则 | utf8mb4_general_ci |
| 存储引擎 | InnoDB |

## 2. 数据表总览

| 序号 | 表名 | 中文名称 | 说明 |
|------|------|----------|------|
| 1 | sys_user | 用户表 | 系统用户信息 |
| 2 | sys_department | 部门表 | 组织架构管理 |
| 3 | sys_role | 角色表 | RBAC角色定义 |
| 4 | sys_permission | 权限表 | 系统功能权限点 |
| 5 | sys_user_role | 用户角色关联表 | 用户与角色多对多关系 |
| 6 | sys_role_permission | 角色权限关联表 | 角色与权限多对多关系 |
| 7 | sys_position | 职位表 | 业务岗位定义 |
| 8 | sys_user_position | 用户职位关联表 | 用户与职位多对多关系 |
| 9 | approval_type | 审批类型表 | 审批业务分类 |
| 10 | workflow_template | 工作流模板表 | 审批流程模板配置 |
| 11 | workflow_node_template | 工作流节点模板表 | 流程节点配置 |
| 12 | approval_record | 审批记录表 | 审批申请主表 |
| 13 | approval_node | 审批节点表 | 审批流程实例节点 |
| 14 | attachment | 附件表 | 文件附件管理 |
| 15 | notification | 通知表 | 系统通知消息 |
| 16 | operation_log | 操作日志表 | 系统操作审计 |

---

## 3. 数据表详细设计

### 3.1 用户表 (sys_user)

存储系统用户基本信息，包含认证和状态管理。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 用户ID |
| username | VARCHAR(50) | NOT NULL, UNIQUE | - | 用户名（登录账号） |
| password | VARCHAR(100) | NOT NULL | - | 密码（BCrypt加密） |
| nickname | VARCHAR(50) | NOT NULL | - | 昵称（显示名称） |
| email | VARCHAR(100) | - | NULL | 邮箱地址 |
| phone | VARCHAR(20) | - | NULL | 手机号 |
| avatar | VARCHAR(255) | - | NULL | 头像文件路径 |
| department_id | BIGINT | FK | NULL | 所属部门ID |
| status | TINYINT | NOT NULL | 1 | 状态: 0-禁用 1-启用 |
| last_login_at | DATETIME | - | NULL | 最后登录时间 |
| last_login_ip | VARCHAR(50) | - | NULL | 最后登录IP |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**:
- `uk_username` (username) - 唯一索引
- `idx_department` (department_id) - 部门查询

> **注意**: 用户的角色和权限通过 `sys_user_role` 关联表获取，支持多角色。

---

### 3.2 部门表 (sys_department)

存储组织架构信息，支持树形结构。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 部门ID |
| name | VARCHAR(100) | NOT NULL | - | 部门名称 |
| parent_id | BIGINT | - | 0 | 父部门ID（0表示顶级部门） |
| leader_id | BIGINT | FK | NULL | 部门负责人ID |
| sort_order | INT | - | 0 | 排序序号 |
| status | TINYINT | NOT NULL | 1 | 状态: 0-禁用 1-启用 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**:
- `idx_parent` (parent_id) - 子部门查询

---

### 3.3 角色表 (sys_role)

定义RBAC系统角色，控制用户对系统功能的访问权限。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 角色ID |
| code | VARCHAR(50) | NOT NULL, UNIQUE | - | 角色编码（如SUPER_ADMIN） |
| name | VARCHAR(100) | NOT NULL | - | 角色名称 |
| description | VARCHAR(255) | - | NULL | 角色描述 |
| status | TINYINT | NOT NULL | 1 | 状态: 0-禁用 1-启用 |
| sort_order | INT | - | 0 | 排序序号 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**:
- `uk_code` (code) - 唯一索引

---

### 3.4 权限表 (sys_permission)

定义系统功能权限点（菜单、按钮、API）。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 权限ID |
| code | VARCHAR(100) | NOT NULL, UNIQUE | - | 权限编码（如user:view） |
| name | VARCHAR(100) | NOT NULL | - | 权限名称 |
| type | VARCHAR(20) | NOT NULL | - | 权限类型: MENU/BUTTON/API |
| parent_id | BIGINT | - | 0 | 父权限ID（树形结构） |
| path | VARCHAR(255) | - | NULL | 路由路径/API路径 |
| icon | VARCHAR(50) | - | NULL | 图标（菜单用） |
| sort_order | INT | - | 0 | 排序序号 |
| status | TINYINT | NOT NULL | 1 | 状态: 0-禁用 1-启用 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `uk_code` (code) - 唯一索引
- `idx_parent` (parent_id) - 父权限查询
- `idx_type` (type) - 类型筛选

---

### 3.5 用户角色关联表 (sys_user_role)

建立用户与角色的多对多关系。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 主键ID |
| user_id | BIGINT | NOT NULL, FK | - | 用户ID |
| role_id | BIGINT | NOT NULL, FK | - | 角色ID |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `uk_user_role` (user_id, role_id) - 唯一约束
- `idx_role_id` (role_id) - 角色查询

---

### 3.6 角色权限关联表 (sys_role_permission)

建立角色与权限的多对多关系。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 主键ID |
| role_id | BIGINT | NOT NULL, FK | - | 角色ID |
| permission_id | BIGINT | NOT NULL, FK | - | 权限ID |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `uk_role_perm` (role_id, permission_id) - 唯一约束
- `idx_permission_id` (permission_id) - 权限查询

---

### 3.7 职位表 (sys_position)

定义业务岗位，用于审批流程等业务场景，与系统权限分离。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 职位ID |
| code | VARCHAR(50) | NOT NULL, UNIQUE | - | 职位编码（如DEPT_MANAGER） |
| name | VARCHAR(100) | NOT NULL | - | 职位名称 |
| description | VARCHAR(255) | - | NULL | 职位描述 |
| level | INT | - | 0 | 职级（用于审批层级） |
| status | TINYINT | NOT NULL | 1 | 状态: 0-禁用 1-启用 |
| sort_order | INT | - | 0 | 排序序号 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**:
- `uk_code` (code) - 唯一索引
- `idx_level` (level) - 职级查询

---

### 3.8 用户职位关联表 (sys_user_position)

建立用户与职位的多对多关系，支持一人多职。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 主键ID |
| user_id | BIGINT | NOT NULL, FK | - | 用户ID |
| position_id | BIGINT | NOT NULL, FK | - | 职位ID |
| is_primary | TINYINT | - | 0 | 是否主职位: 0-否 1-是 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `uk_user_position` (user_id, position_id) - 唯一约束
- `idx_position_id` (position_id) - 职位查询

---

### 3.9 审批类型表 (approval_type)

定义审批业务类型分类。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 类型ID |
| code | VARCHAR(50) | NOT NULL, UNIQUE | - | 类型编码（如LEAVE/EXPENSE） |
| name | VARCHAR(100) | NOT NULL | - | 类型名称 |
| description | VARCHAR(500) | - | NULL | 类型描述 |
| icon | VARCHAR(50) | - | NULL | 图标名称 |
| color | VARCHAR(20) | - | NULL | 主题颜色 |
| sort_order | INT | - | 0 | 排序序号 |
| status | TINYINT | NOT NULL | 1 | 状态: 0-禁用 1-启用 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

---

### 3.10 工作流模板表 (workflow_template)

存储可配置的审批流程模板。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 模板ID |
| name | VARCHAR(100) | NOT NULL | - | 模板名称 |
| type_code | VARCHAR(50) | NOT NULL, FK | - | 关联审批类型编码 |
| description | VARCHAR(500) | - | NULL | 模板描述 |
| status | TINYINT | NOT NULL | 1 | 状态: 0-禁用 1-启用 |
| created_by | BIGINT | NOT NULL, FK | - | 创建人ID |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

**索引**:
- `idx_type_code` (type_code) - 类型关联查询
- `idx_status` (status) - 状态筛选

---

### 3.11 工作流节点模板表 (workflow_node_template)

定义工作流模板中的审批节点配置。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 节点模板ID |
| workflow_id | BIGINT | NOT NULL, FK | - | 工作流模板ID |
| node_name | VARCHAR(100) | NOT NULL | - | 节点名称（如：直属上级） |
| node_order | INT | NOT NULL | - | 节点顺序 |
| approver_type | VARCHAR(20) | NOT NULL | - | 审批人类型 |
| approver_id | BIGINT | - | NULL | 指定审批人/职位ID |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `idx_workflow` (workflow_id) - 关联查询
- `uk_workflow_order` (workflow_id, node_order) - 唯一约束

---

### 3.12 审批记录表 (approval_record)

存储审批申请主记录。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | VARCHAR(36) | PK | - | 审批ID (UUID) |
| title | VARCHAR(200) | NOT NULL | - | 审批标题 |
| type_code | VARCHAR(50) | NOT NULL, FK | - | 审批类型编码 |
| content | TEXT | - | NULL | 审批内容（支持JSON） |
| initiator_id | BIGINT | NOT NULL, FK | - | 发起人ID |
| priority | TINYINT | - | 0 | 紧急程度: 0-普通 1-紧急 2-非常紧急 |
| deadline | DATETIME | - | NULL | 截止日期 |
| status | TINYINT | NOT NULL | 0 | 状态码（见状态枚举） |
| current_node_order | INT | - | 1 | 当前审批节点序号 |
| workflow_id | BIGINT | FK | NULL | 使用的工作流模板ID |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |
| completed_at | DATETIME | - | NULL | 完成时间 |

**索引**:
- `idx_initiator` (initiator_id) - 发起人查询
- `idx_type` (type_code) - 类型筛选
- `idx_status` (status) - 状态筛选
- `idx_created_at` (created_at) - 时间排序

---

### 3.13 审批节点表 (approval_node)

存储审批流程实例的各节点状态。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 节点ID |
| approval_id | VARCHAR(36) | NOT NULL, FK | - | 审批记录ID |
| node_name | VARCHAR(100) | NOT NULL | - | 节点名称 |
| approver_id | BIGINT | NOT NULL, FK | - | 审批人ID |
| node_order | INT | NOT NULL | - | 节点顺序 |
| status | TINYINT | NOT NULL | 0 | 状态: 0-待审批 1-已通过 2-已拒绝 |
| comment | VARCHAR(500) | - | NULL | 审批意见 |
| approved_at | DATETIME | - | NULL | 审批时间 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `idx_approval_id` (approval_id) - 关联查询
- `idx_approver` (approver_id) - 审批人查询
- `uk_approval_order` (approval_id, node_order) - 唯一约束

---

### 3.14 附件表 (attachment)

存储审批相关的文件附件信息。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | VARCHAR(36) | PK | - | 附件ID (UUID) |
| approval_id | VARCHAR(36) | FK | NULL | 关联审批ID |
| original_name | VARCHAR(255) | NOT NULL | - | 原始文件名 |
| stored_name | VARCHAR(255) | NOT NULL | - | 存储文件名 |
| file_path | VARCHAR(500) | NOT NULL | - | 文件存储路径 |
| file_size | BIGINT | NOT NULL | - | 文件大小（字节） |
| file_type | VARCHAR(50) | - | NULL | 文件类型（pdf/docx/xlsx等） |
| mime_type | VARCHAR(100) | - | NULL | MIME 类型 |
| preview_support | TINYINT | - | 0 | 是否支持在线预览: 0-不支持 1-支持 |
| uploader_id | BIGINT | NOT NULL, FK | - | 上传者ID |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `idx_approval_id` (approval_id) - 关联查询
- `idx_uploader` (uploader_id) - 上传者查询

---

### 3.15 通知表 (notification)

存储系统通知消息。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | VARCHAR(36) | PK | - | 通知ID (UUID) |
| user_id | BIGINT | NOT NULL, FK | - | 接收用户ID |
| title | VARCHAR(200) | NOT NULL | - | 通知标题 |
| content | VARCHAR(500) | - | NULL | 通知内容 |
| type | VARCHAR(20) | NOT NULL | - | 通知类型: APPROVAL/SYSTEM/REMINDER |
| related_id | VARCHAR(36) | - | NULL | 关联业务ID |
| is_read | TINYINT | NOT NULL | 0 | 是否已读: 0-未读 1-已读 |
| read_at | DATETIME | - | NULL | 阅读时间 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `idx_user_id` (user_id) - 用户查询
- `idx_user_read` (user_id, is_read) - 未读通知查询
- `idx_created_at` (created_at) - 时间排序

---

### 3.16 操作日志表 (operation_log)

记录系统操作日志，用于审计追踪。

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | PK, AUTO_INCREMENT | - | 日志ID |
| user_id | BIGINT | NOT NULL | - | 操作用户ID |
| module | VARCHAR(50) | NOT NULL | - | 模块名称 |
| operation | VARCHAR(50) | NOT NULL | - | 操作类型 |
| target_id | VARCHAR(36) | - | NULL | 目标业务ID |
| detail | TEXT | - | NULL | 操作详情 |
| ip_address | VARCHAR(50) | - | NULL | 客户端IP地址 |
| user_agent | VARCHAR(500) | - | NULL | 用户代理信息 |
| created_at | DATETIME | - | CURRENT_TIMESTAMP | 创建时间 |

**索引**:
- `idx_user_id` (user_id) - 用户操作查询
- `idx_module` (module) - 模块筛选
- `idx_created_at` (created_at) - 时间范围查询

---

## 4. ER 关系图

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                  RBAC 权限模型                                       │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌──────────────┐     ┌─────────────────┐     ┌─────────────────┐                   │
│  │   sys_user   │     │  sys_user_role  │     │    sys_role     │                   │
│  ├──────────────┤     ├─────────────────┤     ├─────────────────┤                   │
│  │ id (PK)      │◄────│ user_id (FK)    │     │ id (PK)         │                   │
│  │ username     │     │ role_id (FK)    │────►│ code (UK)       │                   │
│  │ nickname     │     └─────────────────┘     │ name            │                   │
│  │ department_id│                             └─────────────────┘                   │
│  └──────────────┘                                      │                            │
│         │                                              │                            │
│         │        ┌─────────────────────┐      ┌────────┴───────┐                    │
│         │        │ sys_role_permission │      │                │                    │
│         │        ├─────────────────────┤      ▼                │                    │
│         │        │ role_id (FK)        │◄─────┤  ┌─────────────────┐                │
│         │        │ permission_id (FK)  │──────│─►│ sys_permission  │                │
│         │        └─────────────────────┘      │  ├─────────────────┤                │
│         │                                     │  │ id (PK)         │                │
│         │                                        │ code (UK)       │                │
│         │                                        │ type            │                │
│         │                                        │ parent_id       │                │
│         │                                        └─────────────────┘                │
│         │                                                                           │
│         │        ┌───────────────────┐       ┌─────────────────┐                    │
│         └───────►│ sys_user_position │──────►│  sys_position   │                    │
│                  ├───────────────────┤       ├─────────────────┤                    │
│                  │ user_id (FK)      │       │ id (PK)         │                    │
│                  │ position_id (FK)  │       │ code (UK)       │                    │
│                  │ is_primary        │       │ level           │                    │
│                  └───────────────────┘       └─────────────────┘                    │
│                                                                                      │
└──────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                  组织架构模型                                        │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌─────────────────┐                         ┌─────────────────┐                    │
│  │  sys_department │                         │    sys_user     │                    │
│  ├─────────────────┤                         ├─────────────────┤                    │
│  │ id (PK)         │◄────────────────────────│ department_id   │                    │
│  │ name            │                         │ id (PK)         │                    │
│  │ parent_id       │ (自关联)                │ username (UK)   │                    │
│  │ leader_id (FK)  │─────────────────────────│                 │                    │
│  └─────────────────┘                         └─────────────────┘                    │
│                                                                                      │
└──────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                  审批流程模型                                        │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌─────────────────┐     ┌───────────────────────┐     ┌─────────────────┐          │
│  │   sys_user      │     │   workflow_template   │     │  approval_type  │          │
│  │                 │     ├───────────────────────┤     ├─────────────────┤          │
│  │ id (PK)         │◄────│ created_by (FK)       │     │ code (UK)       │◄─────┐   │
│  └─────────────────┘     │ type_code (FK)        │────►│ id (PK)         │      │   │
│         │                └───────────────────────┘     │ name            │      │   │
│         │                           │                  └─────────────────┘      │   │
│         │                           ▼                                           │   │
│         │                ┌──────────────────────────┐                           │   │
│         │                │ workflow_node_template   │                           │   │
│         │                ├──────────────────────────┤                           │   │
│         │                │ workflow_id (FK)         │                           │   │
│         │                │ approver_type            │                           │   │
│         │                │ approver_id              │ ← 可关联 sys_position      │   │
│         │                └──────────────────────────┘                           │   │
│         │                                                                       │   │
│         ▼                                                                       │   │
│  ┌─────────────────┐     ┌─────────────────┐                                    │   │
│  │ approval_record │────►│  approval_node  │                                    │   │
│  ├─────────────────┤     ├─────────────────┤                                    │   │
│  │ id (PK/UUID)    │     │ approval_id(FK) │                                    │   │
│  │ initiator_id(FK)│     │ approver_id(FK) │                                    │   │
│  │ type_code (FK)  │─────┼─────────────────┼────────────────────────────────────┘   │
│  │ workflow_id(FK) │     │ status          │                                        │
│  └─────────────────┘     └─────────────────┘                                        │
│         │                                                                           │
│         ▼                                                                           │
│  ┌─────────────────┐     ┌─────────────────┐                                        │
│  │   attachment    │     │  notification   │                                        │
│  ├─────────────────┤     ├─────────────────┤                                        │
│  │ approval_id(FK) │     │ user_id (FK)    │                                        │
│  │ uploader_id(FK) │     │ related_id      │                                        │
│  └─────────────────┘     └─────────────────┘                                        │
│                                                                                      │
└──────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 状态枚举定义

### 5.1 审批记录状态 (approval_record.status)

| 值 | 常量名 | 中文名称 | 说明 |
|----|--------|----------|------|
| 0 | DRAFT | 草稿 | 未提交的审批草稿 |
| 1 | PENDING | 待审批 | 已提交，等待第一个节点审批 |
| 2 | IN_PROGRESS | 审批中 | 多节点流程进行中 |
| 3 | APPROVED | 已通过 | 所有节点审批通过 |
| 4 | REJECTED | 已拒绝 | 任一节点拒绝 |
| 5 | WITHDRAWN | 已撤回 | 发起人主动撤回 |

### 5.2 审批节点状态 (approval_node.status)

| 值 | 常量名 | 中文名称 | 说明 |
|----|--------|----------|------|
| 0 | PENDING | 待审批 | 等待该节点审批 |
| 1 | APPROVED | 已通过 | 该节点审批通过 |
| 2 | REJECTED | 已拒绝 | 该节点审批拒绝 |

### 5.3 审批人类型 (workflow_node_template.approver_type)

| 值 | 说明 |
|----|------|
| USER | 指定用户审批 |
| POSITION | 指定职位审批（如财务、部门经理） |
| DEPARTMENT_HEAD | 发起人所在部门负责人审批 |

### 5.4 权限类型 (sys_permission.type)

| 值 | 说明 |
|----|------|
| MENU | 菜单权限 |
| BUTTON | 按钮权限 |
| API | 接口权限 |

### 5.5 通知类型 (notification.type)

| 值 | 说明 |
|----|------|
| APPROVAL | 审批相关通知 |
| SYSTEM | 系统公告通知 |
| REMINDER | 提醒类通知 |

### 5.6 审批优先级 (approval_record.priority)

| 值 | 说明 |
|----|------|
| 0 | 普通 |
| 1 | 紧急 |
| 2 | 非常紧急 |

---

## 6. 初始化数据

### 6.1 系统角色

| 编码 | 名称 | 描述 |
|------|------|------|
| SUPER_ADMIN | 超级管理员 | 系统最高权限，可管理所有功能 |
| ADMIN | 管理员 | 系统管理功能权限 |
| USER | 普通用户 | 基础功能权限 |

### 6.2 系统权限

| 编码 | 名称 | 类型 | 路径 |
|------|------|------|------|
| dashboard:view | 仪表盘 | MENU | /dashboard |
| approval:view | 审批列表 | MENU | /approval |
| approval:create | 发起审批 | BUTTON | - |
| approval:approve | 审批操作 | BUTTON | - |
| user:view | 用户管理 | MENU | /admin/users |
| user:create | 新增用户 | BUTTON | - |
| user:edit | 编辑用户 | BUTTON | - |
| user:delete | 删除用户 | BUTTON | - |
| role:view | 角色管理 | MENU | /admin/roles |
| role:manage | 角色配置 | BUTTON | - |
| system:config | 系统配置 | MENU | /admin/settings |

### 6.3 业务职位

| 编码 | 名称 | 职级 | 描述 |
|------|------|------|------|
| CEO | 总经理 | 100 | 公司最高决策者 |
| DEPT_MANAGER | 部门经理 | 50 | 部门负责人 |
| TEAM_LEADER | 组长 | 30 | 团队负责人 |
| STAFF | 员工 | 10 | 普通员工 |
| FINANCE | 财务 | 40 | 财务审核职责 |
| HR | 人事 | 40 | 人事管理职责 |

### 6.4 审批类型

| 编码 | 名称 | 描述 | 图标 | 颜色 |
|------|------|------|------|------|
| LEAVE | 请假申请 | 员工请假、调休审批 | calendar | #3B82F6 |
| EXPENSE | 报销申请 | 差旅费、业务费报销 | dollar-sign | #10B981 |
| PURCHASE | 采购申请 | 办公用品、设备采购 | shopping-cart | #8B5CF6 |
| BUSINESS_TRIP | 出差申请 | 外出公干、出差备案 | plane | #F59E0B |
| OVERTIME | 加班申请 | 工作日及节假日加班 | clock | #EF4444 |
| CONTRACT | 合同审批 | 业务合同审核 | file-text | #6366F1 |

### 6.5 部门

| ID | 名称 | 上级部门 | 负责人 |
|----|------|----------|--------|
| 1 | 总经办 | - | admin |
| 2 | 人事行政部 | 总经办 | hr_admin |
| 3 | 技术部 | 总经办 | tech_lead |
| 4 | 财务部 | 总经办 | finance_mgr |
| 5 | 市场部 | 总经办 | market_mgr |
| 6 | 前端开发组 | 技术部 | wang_fe |
| 7 | 后端开发组 | 技术部 | chen_be |
| 8 | 测试组 | 技术部 | wu_test |
| 9 | 品牌推广组 | 市场部 | he_brand |
| 10 | 销售组 | 市场部 | lin_sales |

### 6.6 用户账号

> **注意**：所有测试账号密码均为 `admin123` (BCrypt加密)

| ID | 用户名 | 昵称 | 角色 | 职位 | 部门 |
|----|--------|------|------|------|------|
| 1 | admin | 系统管理员 | 超级管理员 | 总经理 | 总经办 |
| 2 | hr_admin | 人事经理 | 管理员 | 部门经理、人事 | 人事行政部 |
| 3 | tech_lead | 技术总监 | 管理员 | 部门经理 | 技术部 |
| 4 | finance_mgr | 财务经理 | 管理员 | 部门经理、财务 | 财务部 |
| 5 | market_mgr | 市场总监 | 管理员 | 部门经理 | 市场部 |
| 6 | wang_fe | 王前端 | 普通用户 | 组长 | 前端开发组 |
| 7 | zhao_fe | 赵前端 | 普通用户 | 员工 | 前端开发组 |
| 8 | liu_fe | 刘前端 | 普通用户 | 员工 | 前端开发组 |
| 9 | chen_be | 陈后端 | 普通用户 | 组长 | 后端开发组 |
| 10 | yang_be | 杨后端 | 普通用户 | 员工 | 后端开发组 |
| 11 | zhou_be | 周后端 | 普通用户 | 员工 | 后端开发组 |
| 12 | wu_test | 吴测试 | 普通用户 | 组长 | 测试组 |
| 13 | sun_test | 孙测试 | 普通用户 | 员工 | 测试组 |
| 14 | zheng_hr | 郑人事 | 普通用户 | 员工、人事 | 人事行政部 |
| 15 | qian_fin | 钱财务 | 普通用户 | 员工、财务 | 财务部 |
| 16 | ma_fin | 马财务 | 普通用户 | 员工、财务 | 财务部 |
| 17 | he_brand | 何品牌 | 普通用户 | 组长 | 品牌推广组 |
| 18 | lin_sales | 林销售 | 普通用户 | 组长 | 销售组 |
| 19 | xu_sales | 徐销售 | 普通用户 | 员工 | 销售组 |

### 6.7 工作流模板

| ID | 名称 | 审批类型 | 审批节点 |
|----|------|----------|----------|
| 1 | 普通请假流程 | LEAVE | 部门负责人 → 人事 |
| 2 | 费用报销流程 | EXPENSE | 部门负责人 → 财务 → 总经理 |
| 3 | 采购申请流程 | PURCHASE | 部门负责人 → 财务 |
| 4 | 出差申请流程 | BUSINESS_TRIP | 部门负责人 → 人事 |
| 5 | 加班申请流程 | OVERTIME | 部门负责人 |
| 6 | 合同审批流程 | CONTRACT | 部门负责人 → 财务 → 总经理 |

### 6.8 开发测试数据

初始化脚本包含以下开发测试数据，用于系统开发和功能验证：

| 数据类型 | 数量 | 说明 |
|----------|------|------|
| 审批记录 | 13条 | 包含草稿、待审批、审批中、已通过、已拒绝、已撤回等各种状态 |
| 审批节点 | 26条 | 对应审批记录的流程节点数据 |
| 通知消息 | 16条 | 包含系统通知、审批待办、审批结果、提醒等类型 |
| 操作日志 | 20条 | 包含登录、用户管理、审批操作、工作流管理等日志 |

---

## 7. 数据库脚本

完整的数据库初始化脚本请参见：[script/init_database.sql](../script/init_database.sql)

